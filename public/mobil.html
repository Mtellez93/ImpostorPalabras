<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Jugador</title>
<link rel="stylesheet" href="style.css">
<script src="/socket.io/socket.io.js"></script>
</head>
<body>

<div class="container">

<div class="card">
<input id="room" placeholder="C√≥digo sala">
<input id="name" placeholder="Nombre">
<button onclick="join()">Entrar</button>
</div>

<div class="card role-card" id="role"></div>

<div class="card vote-list" id="vote"></div>

</div>

<script>
const socket=io();
let room="";

function join(){
 room=document.getElementById("room").value.toUpperCase();
 socket.emit("join",{room,name:document.getElementById("name").value});
}

socket.on("role",d=>{
 document.getElementById("role").innerText =
 d.impostor ? "üòà Eres el impostor" : "üìù "+d.word;
});

socket.on("phase",p=>{
 if(p!=="voting") document.getElementById("vote").innerHTML="";
});

socket.on("players",list=>{
 socket.on("phase",phase=>{
  if(phase==="voting"){
   document.getElementById("vote").innerHTML =
   list.filter(p=>p.alive).map(p=>
     `<button onclick="vote('${p.id}')">${p.name}</button>`
   ).join("");
  }
 });
});

function vote(target){
 socket.emit("vote",{room,target});
 document.getElementById("vote").innerHTML="‚úîÔ∏è Voto enviado";
}
</script>

</body>
</html>
