<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Impostor Fiesta Pro</title>
<link rel="stylesheet" href="style.css">
<script src="/socket.io/socket.io.js"></script>
</head>
<body>

<h1>SALA <span id="room">----</span></h1>

<div id="qr"></div>

<button onclick="startRound()">Iniciar ronda</button>
<button onclick="startVoting()">Iniciar votaci√≥n</button>
<button onclick="nextRound()">Siguiente ronda</button>

<h2 id="phase"></h2>

<h3>Jugadores</h3>
<div id="players"></div>

<h3 id="voteStatus"></h3>

<script>
const socket=io();
let room="";

socket.emit("create");

socket.on("room",r=>{
 room=r;
 document.getElementById("room").innerText=r;

 const url=location.origin+"/mobil.html";
 const qr=`https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${url}`;
 document.getElementById("qr").innerHTML=`<img src="${qr}">`;
});

socket.on("players",list=>{
 document.getElementById("players").innerHTML=list.map(p=>p.name).join("<br>");
});

socket.on("phase",p=>{
 document.getElementById("phase").innerText=p;
});

socket.on("voteStatus",s=>{
 document.getElementById("voteStatus").innerText=`Votos: ${s.votedCount}/${s.total}`;
});

socket.on("result",r=>{
 alert(`${r.name} ${r.wasImpostor?"ERA":"NO ERA"} el impostor`);
});

function startRound(){
 socket.emit("startRound",room);
}

function startVoting(){
 socket.emit("startVoting",room);
}

function nextRound(){
 socket.emit("startRound",room);
}
</script>

</body>
</html>
